{% extends "base.html" %}
{% block title %}Admin Dashboard{% endblock %}
{% block content %}
<style>
    :root {
        --primary: #3674B5;
        --secondary: #578FCA;
        --light: #A1E3F9;
        --lighter: #D1F8EF;
    }

    .sidebar {
        background: linear-gradient(180deg, var(--primary) 0%, var(--secondary) 100%);
        width: 250px;
        position: fixed;
        height: 100vh;
        overflow-y: auto;
    }

    .sidebar .nav-link {
        color: #fff !important;
        padding: 12px 15px;
        border-radius: 5px;
        margin-bottom: 5px;
    }

    .sidebar .nav-link:hover,
    .sidebar .nav-link.active {
        background-color: var(--light);
        color: var(--primary) !important;
    }

    .main-content {
        margin-left: 250px;
        padding: 20px;
        background-color: #f8f9fa;
        min-height: 100vh;
    }

    .stat-card {
        border-left: 4px solid var(--primary);
        transition: transform 0.2s;
    }

    .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
</style>

<div class="d-flex" style="min-height: 100vh;">
    <!-- Sidebar -->
    <div class="sidebar text-white p-4">
        <h4 class="mb-4">
            <i class="fas fa-user-shield"></i> Admin Panel
        </h4>
        <hr class="bg-light">
        <nav class="nav flex-column">
            <a class="nav-link active" href="{{ url_for('admin.dashboard') }}">
                <i class="fas fa-home"></i> Dashboard
            </a>
            <a class="nav-link" href="{{ url_for('admin.pending_approvals') }}">
                <i class="fas fa-clock"></i> Pending Approvals
                {% if stats.pending_approvals > 0 %}
                    <span class="badge bg-danger ms-2">{{ stats.pending_approvals }}</span>
                {% endif %}
            </a>
            <a class="nav-link" href="{{ url_for('admin.users') }}">
                <i class="fas fa-users-cog"></i> All Users
            </a>
            <a class="nav-link" href="{{ url_for('admin.doctors') }}">
                <i class="fas fa-user-md"></i> Doctors
            </a>
            <a class="nav-link" href="{{ url_for('admin.nurses') }}">
                <i class="fas fa-user-nurse"></i> Nurses
            </a>
            <a class="nav-link" href="{{ url_for('admin.patients') }}">
                <i class="fas fa-procedures"></i> Patients
            </a>
            <a class="nav-link" href="{{ url_for('admin.appointments') }}">
                <i class="fas fa-calendar-check"></i> Appointments
            </a>
            <a class="nav-link" href="{{ url_for('admin.analytics') }}">
                <i class="fas fa-chart-line"></i> Analytics
            </a>
            <a class="nav-link" href="{{ url_for('admin.manage_admins') }}">
                <i class="fas fa-user-shield"></i> Admins
            </a>
            <hr class="bg-light">
            <a class="nav-link" href="{{ url_for('auth.logout') }}">
                <i class="fas fa-sign-out-alt"></i> Logout
            </a>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>
                <i class="fas fa-tachometer-alt"></i> Admin Dashboard
            </h2>
            <div>
                <span class="badge bg-primary">Welcome, {{ current_user.username }}!</span>
            </div>
        </div>

        <!-- Statistics Cards -->
        <div class="row mb-4">
            <div class="col-md-3 mb-3">
                <div class="card stat-card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-2">Total Users</h6>
                                <h3 class="mb-0">{{ stats.total_users }}</h3>
                            </div>
                            <i class="fas fa-users fa-2x text-primary"></i>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card stat-card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-2">Doctors</h6>
                                <h3 class="mb-0">{{ stats.total_doctors }}</h3>
                            </div>
                            <i class="fas fa-user-md fa-2x" style="color: var(--secondary);"></i>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card stat-card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-2">Nurses</h6>
                                <h3 class="mb-0">{{ stats.total_nurses }}</h3>
                            </div>
                            <i class="fas fa-user-nurse fa-2x" style="color: #28a745;"></i>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card stat-card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-2">Pending Approvals</h6>
                                <h3 class="mb-0 text-danger">{{ stats.pending_approvals }}</h3>
                            </div>
                            <i class="fas fa-clock fa-2x text-warning"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Additional Stats Row -->
        <div class="row mb-4">
            <div class="col-md-3 mb-3">
                <div class="card stat-card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-2">Patient Records</h6>
                                <h3 class="mb-0">{{ stats.total_patient_records }}</h3>
                            </div>
                            <i class="fas fa-procedures fa-2x" style="color: #17a2b8;"></i>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card stat-card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-2">Appointments</h6>
                                <h3 class="mb-0">{{ stats.total_appointments }}</h3>
                            </div>
                            <i class="fas fa-calendar-check fa-2x" style="color: #ffc107;"></i>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card stat-card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-2">Dataset Records</h6>
                                <h3 class="mb-0">{{ stats.total_dataset_records }}</h3>
                            </div>
                            <i class="fas fa-database fa-2x" style="color: #6f42c1;"></i>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card stat-card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-2">Stroke Cases</h6>
                                <h3 class="mb-0 text-danger">{{ stats.stroke_cases }}</h3>
                            </div>
                            <i class="fas fa-heartbeat fa-2x text-danger"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Users -->
        <div class="card">
            <div class="card-header" style="background-color: var(--lighter);">
                <h5 class="mb-0">
                    <i class="fas fa-users"></i> Recent Users
                </h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Status</th>
                                <th>Registered</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for user in recent_users %}
                            <tr>
                                <td><i class="fas fa-user"></i> {{ user.username }}</td>
                                <td>{{ user.email }}</td>
                                <td>
                                    <span class="badge bg-primary">{{ user.role.name if user.role else 'N/A' }}</span>
                                </td>
                                <td>
                                    {% if user.is_active %}
                                        <span class="badge bg-success">Active</span>
                                    {% else %}
                                        <span class="badge bg-secondary">Inactive</span>
                                    {% endif %}
                                </td>
                                <td>{{ user.created_at.strftime('%Y-%m-%d') if user.created_at else 'N/A' }}</td>
                            </tr>
                            {% else %}
                            <tr>
                                <td colspan="5" class="text-center text-muted">No users found</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
{% endblock %}